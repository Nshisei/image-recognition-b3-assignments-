# ディジタル画像処理課題
学部3年生のディジタル画像処理の課題で作成したもの
情報システム工学演習 II 「画像処理演習」の内容で実装したアプリケーション（[Image-processing-with-OpenCV](https://github.com/Nshisei/Image-processing-with-OpenCV)）で、手の形から何の印を結んでいるか検出する必要があったのだが既存のアプリやライブラリを組み合わせるだけではうまくいかなかったため、本課題でその解決する。

## プログラム概要
PC内蔵カメラから取得できる手を含んだ画像が、「NARUTO -ナルト-」中に登場する印を結んでいるか。その中でも「子」「丑」「寅」「卯」「辰」「巳」「午」「未」「申」「酉」「戌」「亥」のどれかを分類する。

機械学習による画像分類を行う。機械学習を選択した理由は、前述の通り既存のアプリケーションであるMediapipeでは、両手を結んだときに片手しか認識されないという問題が発生してしまいMediapipeのもつ手のランドマーク相対位置を使った印の検出が難しいためである。

## プログラム構成
movies: 学習データを生成するための動画セット（Google Driveのhandsign以下に全中身を配置）
handsign.ipynb: データセットの生成・学習
realtime_handsign.py: 分類器の構造・学習した重みを使って内蔵カメラから印を検出する
vgg16.hdf5: 分類器重み
vgg16.json: 分類器構造

## データ収集方法
印を結んでいる動画を撮影し、それをffmpegコマンドを使って連続したjpg画像に変換する。これによって、30フレームで1分間撮影するだけで30×60=1800枚の画像を生成することができる。今回12種類の分類を行うため12分撮影すると各印ごとに1800枚の画像が作れる。一回の撮影だけでは背景が変わらないため、画角や服装を5回繰り返すことで、各分類ごとに9000枚、全体で108000のデータセットを作成できる。このデータセットを使って学習を行う。なお、テストを行う際は、また別の画角、服装で各印ごとに20秒間撮影して作成した7200枚のデータセットを用いる。
上記の動画はmoviesディレクトリに保存されている

## 結果
![スクリーンショット 2022-10-04 12 56 26](https://user-images.githubusercontent.com/103732456/193732340-e747e687-dfcf-46f3-a78c-f91e6ec8da30.png)
テストデータ：正解率 89.62

## リアルタイム認識
![スクリーンショット 2022-10-04 12 56 58](https://user-images.githubusercontent.com/103732456/193732341-e76b5450-b9d2-4b62-95e2-cb6768800c7c.png)